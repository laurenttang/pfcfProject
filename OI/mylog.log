Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 19, in <module>
    from mpl_finance import candlestick_ohlc
ModuleNotFoundError: No module named 'mpl_finance'
2021-01-18 06:15:02.407679
20210118
2021-01-20
202101
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 92, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
2021-01-18 06:16:02.919735
20210118
2021-01-20
202101
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 92, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
2021-01-18 06:17:02.505921
20210118
2021-01-20
202101
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 92, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
2021-01-18 06:18:03.041731
20210118
2021-01-20
202101
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 93, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
2021-01-18 06:19:02.676361
20210118
2021-01-20
202101
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 93, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
2021-01-18 17:30:02.667260
20210118
2021-01-20
202101
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 93, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-01-19 10:40:03.929951
today:20210119
queryday:20210118
enddate:2021-01-20
202101
   Twseclose
0      15612
14700 16500
        Date Type Contract Strike Openinterest  id
0   20210119   買權   202101  14800         6433   1
1   20210119   賣權   202101  14800        11633   2
2   20210119   買權   202101  14900         4142   3
3   20210119   賣權   202101  14900         7674   4
4   20210119   買權   202101  15000         6868   5
5   20210119   賣權   202101  15000        13028   6
6   20210119   買權   202101  15050            2   7
7   20210119   賣權   202101  15050         4320   8
8   20210119   買權   202101  15100            8   9
9   20210119   賣權   202101  15100         8548  10
10  20210119   買權   202101  15150            6  11
11  20210119   賣權   202101  15150         6102  12
12  20210119   買權   202101  15200         5898  13
13  20210119   賣權   202101  15200        11068  14
14  20210119   買權   202101  15250          133  15
15  20210119   賣權   202101  15250         5657  16
16  20210119   買權   202101  15300          336  17
17  20210119   賣權   202101  15300        11400  18
18  20210119   買權   202101  15350          220  19
19  20210119   賣權   202101  15350         7340  20
20  20210119   買權   202101  15400        10322  21
21  20210119   賣權   202101  15400        16438  22
22  20210119   買權   202101  15450          766  23
23  20210119   賣權   202101  15450         8947  24
24  20210119   買權   202101  15500         1483  25
25  20210119   賣權   202101  15500        12225  26
26  20210119   買權   202101  15550         2380  27
27  20210119   賣權   202101  15550         8470  28
28  20210119   買權   202101  15600         7424  29
29  20210119   賣權   202101  15600        20154  30
30  20210119   買權   202101  15650         3428  31
31  20210119   賣權   202101  15650        17132  32
32  20210119   買權   202101  15700         5704  33
33  20210119   賣權   202101  15700        19681  34
34  20210119   買權   202101  15750         5200  35
35  20210119   賣權   202101  15750        11000  36
36  20210119   買權   202101  15800        13601  37
37  20210119   賣權   202101  15800        11963  38
38  20210119   買權   202101  15850         7445  39
39  20210119   賣權   202101  15850         5820  40
40  20210119   買權   202101  15900         9847  41
41  20210119   賣權   202101  15900         5941  42
42  20210119   買權   202101  15950        10196  43
43  20210119   賣權   202101  15950         3255  44
44  20210119   買權   202101  16000        19324  45
45  20210119   賣權   202101  16000         3898  46
46  20210119   買權   202101  16050         7920  47
47  20210119   賣權   202101  16050          363  48
48  20210119   買權   202101  16100        12582  49
49  20210119   賣權   202101  16100          425  50
50  20210119   買權   202101  16150         7489  51
51  20210119   賣權   202101  16150          142  52
52  20210119   買權   202101  16200        11580  53
53  20210119   賣權   202101  16200          283  54
54  20210119   買權   202101  16300        12960  55
55  20210119   賣權   202101  16300           35  56
56  20210119   買權   202101  16400         8539  57
57  20210119   賣權   202101  16400           20  58
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-20 09:30:03.165584
today:20210120
queryday:20210119
enddate:2021-01-20
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-01-21 09:30:03.046854
today:20210121
queryday:20210120
enddate:2021-01-20
202102
   Twseclose
0      15806
14900 16700
        Date Type  Contract Strike Openinterest  id
0   20210121   買權  202102    15000          827   1
1   20210121   賣權  202102    15000         5391   2
2   20210121   買權  202102    15100           14   3
3   20210121   賣權  202102    15100         3099   4
4   20210121   買權  202102    15200         1445   5
5   20210121   賣權  202102    15200         2001   6
6   20210121   買權  202102    15300          616   7
7   20210121   賣權  202102    15300         1156   8
8   20210121   買權  202102    15400         2691   9
9   20210121   賣權  202102    15400         2149  10
10  20210121   買權  202102    15500          213  11
11  20210121   賣權  202102    15500         2816  12
12  20210121   買權  202102    15600         1127  13
13  20210121   賣權  202102    15600         1637  14
14  20210121   買權  202102    15700          597  15
15  20210121   賣權  202102    15700         1522  16
16  20210121   買權  202102    15800         2462  17
17  20210121   賣權  202102    15800         1873  18
18  20210121   買權  202102    15900         1656  19
19  20210121   賣權  202102    15900         2587  20
20  20210121   買權  202102    16000         3582  21
21  20210121   賣權  202102    16000         1402  22
22  20210121   買權  202102    16100         1801  23
23  20210121   賣權  202102    16100         1160  24
24  20210121   買權  202102    16200         2427  25
25  20210121   賣權  202102    16200          329  26
26  20210121   買權  202102    16300         1860  27
27  20210121   賣權  202102    16300          151  28
28  20210121   買權  202102    16400         3706  29
29  20210121   賣權  202102    16400           60  30
30  20210121   買權  202102    16500         1989  31
31  20210121   賣權  202102    16500           23  32
32  20210121   買權  202102    16600         4403  33
33  20210121   賣權  202102    16600           15  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-22 09:30:02.814542
today:20210122
queryday:20210121
enddate:2021-01-20
202102
   Twseclose
0      16153
15200 17000
        Date Type  Contract Strike Openinterest  id
0   20210122   買權  202102    15300          823   1
1   20210122   賣權  202102    15300         1708   2
2   20210122   買權  202102    15400         3004   3
3   20210122   賣權  202102    15400         2164   4
4   20210122   買權  202102    15500          226   5
5   20210122   賣權  202102    15500         3820   6
6   20210122   買權  202102    15600         1061   7
7   20210122   賣權  202102    15600         1594   8
8   20210122   買權  202102    15700          599   9
9   20210122   賣權  202102    15700         2455  10
10  20210122   買權  202102    15800         2485  11
11  20210122   賣權  202102    15800         2947  12
12  20210122   買權  202102    15900         1744  13
13  20210122   賣權  202102    15900         3744  14
14  20210122   買權  202102    16000         4584  15
15  20210122   賣權  202102    16000         2001  16
16  20210122   買權  202102    16100         2363  17
17  20210122   賣權  202102    16100         1559  18
18  20210122   買權  202102    16200         2507  19
19  20210122   賣權  202102    16200          350  20
20  20210122   買權  202102    16300         2129  21
21  20210122   賣權  202102    16300          138  22
22  20210122   買權  202102    16400         4383  23
23  20210122   賣權  202102    16400           69  24
24  20210122   買權  202102    16500         2234  25
25  20210122   賣權  202102    16500           28  26
26  20210122   買權  202102    16600         4950  27
27  20210122   賣權  202102    16600           23  28
28  20210122   買權  202102    16700         2132  29
29  20210122   賣權  202102    16700            0  30
30  20210122   買權  202102    16800         3739  31
31  20210122   賣權  202102    16800            7  32
32  20210122   買權  202102    16900         2710  33
33  20210122   賣權  202102    16900            0  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-23 09:30:05.456654
today:20210123
queryday:20210122
enddate:2021-01-20
202102
   Twseclose
0      16019
15100 16900
Empty DataFrame
Columns: [Date, Type, Contract, Strike, Openinterest, id]
Index: []
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id              object
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id              object
dtype: object
now:2021-01-25 09:30:03.564753
today:20210125
queryday:20210122
enddate:2021-01-20
202102
   Twseclose
0      16019
15100 16900
        Date Type  Contract Strike Openinterest  id
0   20210125   買權  202102    15200         1600   1
1   20210125   賣權  202102    15200         2915   2
2   20210125   買權  202102    15300         1079   3
3   20210125   賣權  202102    15300         1783   4
4   20210125   買權  202102    15400         3252   5
5   20210125   賣權  202102    15400         2217   6
6   20210125   買權  202102    15500          252   7
7   20210125   賣權  202102    15500         2793   8
8   20210125   買權  202102    15600         1095   9
9   20210125   賣權  202102    15600         2791  10
10  20210125   買權  202102    15700          663  11
11  20210125   賣權  202102    15700         2536  12
12  20210125   買權  202102    15800         2927  13
13  20210125   賣權  202102    15800         3478  14
14  20210125   買權  202102    15900         2758  15
15  20210125   賣權  202102    15900         3997  16
16  20210125   買權  202102    16000         5370  17
17  20210125   賣權  202102    16000         1794  18
18  20210125   買權  202102    16100         2513  19
19  20210125   賣權  202102    16100         1552  20
20  20210125   買權  202102    16200         3315  21
21  20210125   賣權  202102    16200          324  22
22  20210125   買權  202102    16300         2519  23
23  20210125   賣權  202102    16300          130  24
24  20210125   買權  202102    16400         4948  25
25  20210125   賣權  202102    16400           89  26
26  20210125   買權  202102    16500         2714  27
27  20210125   賣權  202102    16500           29  28
28  20210125   買權  202102    16600         5455  29
29  20210125   賣權  202102    16600           25  30
30  20210125   買權  202102    16700         2693  31
31  20210125   賣權  202102    16700            0  32
32  20210125   買權  202102    16800         4814  33
33  20210125   賣權  202102    16800            5  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-26 09:30:03.497507
today:20210126
queryday:20210125
enddate:2021-01-20
202102
   Twseclose
0      15946
15000 16800
        Date Type  Contract Strike Openinterest  id
0   20210126   買權  202102    15100           14   1
1   20210126   賣權  202102    15100         3218   2
2   20210126   買權  202102    15200         1574   3
3   20210126   賣權  202102    15200         3065   4
4   20210126   買權  202102    15300         1111   5
5   20210126   賣權  202102    15300         3148   6
6   20210126   買權  202102    15400         3225   7
7   20210126   賣權  202102    15400         2936   8
8   20210126   買權  202102    15500          313   9
9   20210126   賣權  202102    15500         3060  10
10  20210126   買權  202102    15600         1336  11
11  20210126   賣權  202102    15600         2839  12
12  20210126   買權  202102    15700         1681  13
13  20210126   賣權  202102    15700         2939  14
14  20210126   買權  202102    15800         3722  15
15  20210126   賣權  202102    15800         3991  16
16  20210126   買權  202102    15900         3839  17
17  20210126   賣權  202102    15900         2880  18
18  20210126   買權  202102    16000         6287  19
19  20210126   賣權  202102    16000         1744  20
20  20210126   買權  202102    16100         3985  21
21  20210126   賣權  202102    16100         1477  22
22  20210126   買權  202102    16200         4077  23
23  20210126   賣權  202102    16200          340  24
24  20210126   買權  202102    16300         2967  25
25  20210126   賣權  202102    16300          125  26
26  20210126   買權  202102    16400         5293  27
27  20210126   賣權  202102    16400           77  28
28  20210126   買權  202102    16500         3533  29
29  20210126   賣權  202102    16500           24  30
30  20210126   買權  202102    16600         5728  31
31  20210126   賣權  202102    16600           21  32
32  20210126   買權  202102    16700         2621  33
33  20210126   賣權  202102    16700            0  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-27 09:30:03.184538
today:20210127
queryday:20210126
enddate:2021-01-20
202102
   Twseclose
0      15658
14700 16500
        Date Type  Contract Strike Openinterest  id
0   20210127   買權  202102    14800          840   1
1   20210127   賣權  202102    14800         4556   2
2   20210127   買權  202102    14900          411   3
3   20210127   賣權  202102    14900         3273   4
4   20210127   買權  202102    15000          770   5
5   20210127   賣權  202102    15000         5358   6
6   20210127   買權  202102    15100           14   7
7   20210127   賣權  202102    15100         3238   8
8   20210127   買權  202102    15200         1592   9
9   20210127   賣權  202102    15200         2875  10
10  20210127   買權  202102    15300         1116  11
11  20210127   賣權  202102    15300         3793  12
12  20210127   買權  202102    15400         3192  13
13  20210127   賣權  202102    15400         3440  14
14  20210127   買權  202102    15500          379  15
15  20210127   賣權  202102    15500         3089  16
16  20210127   買權  202102    15600         1535  17
17  20210127   賣權  202102    15600         2905  18
18  20210127   買權  202102    15700         2514  19
19  20210127   賣權  202102    15700         3665  20
20  20210127   買權  202102    15800         3746  21
21  20210127   賣權  202102    15800         4199  22
22  20210127   買權  202102    15900         3928  23
23  20210127   賣權  202102    15900         2894  24
24  20210127   買權  202102    16000         6733  25
25  20210127   賣權  202102    16000         1592  26
26  20210127   買權  202102    16100         4816  27
27  20210127   賣權  202102    16100         1458  28
28  20210127   買權  202102    16200         4248  29
29  20210127   賣權  202102    16200          338  30
30  20210127   買權  202102    16300         4464  31
31  20210127   賣權  202102    16300          124  32
32  20210127   買權  202102    16400         5578  33
33  20210127   賣權  202102    16400           80  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-28 09:30:02.734837
today:20210128
queryday:20210127
enddate:2021-01-20
202102
   Twseclose
0      15701
14800 16600
        Date Type  Contract Strike Openinterest  id
0   20210128   買權  202102    14900          412   1
1   20210128   賣權  202102    14900         3421   2
2   20210128   買權  202102    15000          779   3
3   20210128   賣權  202102    15000         5250   4
4   20210128   買權  202102    15100           74   5
5   20210128   賣權  202102    15100         5031   6
6   20210128   買權  202102    15200         1601   7
7   20210128   賣權  202102    15200         2559   8
8   20210128   買權  202102    15300         1172   9
9   20210128   賣權  202102    15300         2730  10
10  20210128   買權  202102    15400         3615  11
11  20210128   賣權  202102    15400         3720  12
12  20210128   買權  202102    15500          983  13
13  20210128   賣權  202102    15500         3132  14
14  20210128   買權  202102    15600         2518  15
15  20210128   賣權  202102    15600         2801  16
16  20210128   買權  202102    15700         3150  17
17  20210128   賣權  202102    15700         3530  18
18  20210128   買權  202102    15800         4336  19
19  20210128   賣權  202102    15800         4146  20
20  20210128   買權  202102    15900         4328  21
21  20210128   賣權  202102    15900         2811  22
22  20210128   買權  202102    16000         8466  23
23  20210128   賣權  202102    16000         1713  24
24  20210128   買權  202102    16100         5969  25
25  20210128   賣權  202102    16100         1402  26
26  20210128   買權  202102    16200         4809  27
27  20210128   賣權  202102    16200          340  28
28  20210128   買權  202102    16300         4608  29
29  20210128   賣權  202102    16300          125  30
30  20210128   買權  202102    16400         5911  31
31  20210128   賣權  202102    16400           78  32
32  20210128   買權  202102    16500         3877  33
33  20210128   賣權  202102    16500           24  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-01-29 09:30:03.358835
today:20210129
queryday:20210128
enddate:2021-01-20
202102
   Twseclose
0      15415
14500 16300
        Date Type  Contract Strike Openinterest  id
0   20210129   買權  202102    14600          516   1
1   20210129   賣權  202102    14600         4695   2
2   20210129   買權  202102    14700          478   3
3   20210129   賣權  202102    14700         3406   4
4   20210129   買權  202102    14800          853   5
5   20210129   賣權  202102    14800         5823   6
6   20210129   買權  202102    14900          430   7
7   20210129   賣權  202102    14900         4041   8
8   20210129   買權  202102    15000          861   9
9   20210129   賣權  202102    15000         5705  10
10  20210129   買權  202102    15100          251  11
11  20210129   賣權  202102    15100         3036  12
12  20210129   買權  202102    15200         1726  13
13  20210129   賣權  202102    15200         2766  14
14  20210129   買權  202102    15300         1757  15
15  20210129   賣權  202102    15300         2841  16
16  20210129   買權  202102    15400         4835  17
17  20210129   賣權  202102    15400         3602  18
18  20210129   買權  202102    15500         2560  19
19  20210129   賣權  202102    15500         3089  20
20  20210129   買權  202102    15600         3258  21
21  20210129   賣權  202102    15600         2670  22
22  20210129   買權  202102    15700         3529  23
23  20210129   賣權  202102    15700         3398  24
24  20210129   買權  202102    15800         6582  25
25  20210129   賣權  202102    15800         4054  26
26  20210129   買權  202102    15900         5978  27
27  20210129   賣權  202102    15900         2682  28
28  20210129   買權  202102    16000         8542  29
29  20210129   賣權  202102    16000         1681  30
30  20210129   買權  202102    16100         6052  31
31  20210129   賣權  202102    16100         1388  32
32  20210129   買權  202102    16200         4922  33
33  20210129   賣權  202102    16200          323  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-01 09:30:03.125177
today:20210201
queryday:20210129
enddate:2021-02-17
202102
   Twseclose
0      15138
14200 16000
        Date Type  Contract Strike Openinterest  id
0   20210201   買權  202102    14300           74   1
1   20210201   賣權  202102    14300         2498   2
2   20210201   買權  202102    14400          136   3
3   20210201   賣權  202102    14400         5000   4
4   20210201   買權  202102    14500          303   5
5   20210201   賣權  202102    14500        18311   6
6   20210201   買權  202102    14600          518   7
7   20210201   賣權  202102    14600         4866   8
8   20210201   買權  202102    14700          476   9
9   20210201   賣權  202102    14700         3479  10
10  20210201   買權  202102    14800          854  11
11  20210201   賣權  202102    14800         5644  12
12  20210201   買權  202102    14900          488  13
13  20210201   賣權  202102    14900         3503  14
14  20210201   買權  202102    15000          924  15
15  20210201   賣權  202102    15000         5953  16
16  20210201   買權  202102    15100          441  17
17  20210201   賣權  202102    15100         3676  18
18  20210201   買權  202102    15200         1803  19
19  20210201   賣權  202102    15200         2775  20
20  20210201   買權  202102    15300         1901  21
21  20210201   賣權  202102    15300         2910  22
22  20210201   買權  202102    15400         3983  23
23  20210201   賣權  202102    15400         3678  24
24  20210201   買權  202102    15500         2420  25
25  20210201   賣權  202102    15500         3035  26
26  20210201   買權  202102    15600         4374  27
27  20210201   賣權  202102    15600         2632  28
28  20210201   買權  202102    15700         5432  29
29  20210201   賣權  202102    15700         3363  30
30  20210201   買權  202102    15800         6677  31
31  20210201   賣權  202102    15800         4006  32
32  20210201   買權  202102    15900         5796  33
33  20210201   賣權  202102    15900         2654  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-02 09:30:02.688463
today:20210202
queryday:20210201
enddate:2021-02-17
202102
   Twseclose
0      15410
14500 16300
        Date Type  Contract Strike Openinterest  id
0   20210202   買權  202102    14600          516   1
1   20210202   賣權  202102    14600         4804   2
2   20210202   買權  202102    14700          480   3
3   20210202   賣權  202102    14700         4078   4
4   20210202   買權  202102    14800          850   5
5   20210202   賣權  202102    14800         6573   6
6   20210202   買權  202102    14900          476   7
7   20210202   賣權  202102    14900         4192   8
8   20210202   買權  202102    15000          954   9
9   20210202   賣權  202102    15000         7737  10
10  20210202   買權  202102    15100          348  11
11  20210202   賣權  202102    15100         3494  12
12  20210202   買權  202102    15200         1819  13
13  20210202   賣權  202102    15200         3025  14
14  20210202   買權  202102    15300         1750  15
15  20210202   賣權  202102    15300         3251  16
16  20210202   買權  202102    15400         3792  17
17  20210202   賣權  202102    15400         4523  18
18  20210202   買權  202102    15500         2099  19
19  20210202   賣權  202102    15500         4026  20
20  20210202   買權  202102    15600         3220  21
21  20210202   賣權  202102    15600         3301  22
22  20210202   買權  202102    15700         4611  23
23  20210202   賣權  202102    15700         3868  24
24  20210202   買權  202102    15800         7099  25
25  20210202   賣權  202102    15800         4613  26
26  20210202   買權  202102    15900         5219  27
27  20210202   賣權  202102    15900         2611  28
28  20210202   買權  202102    16000         8995  29
29  20210202   賣權  202102    16000         1780  30
30  20210202   買權  202102    16100         4904  31
31  20210202   賣權  202102    16100         1430  32
32  20210202   買權  202102    16200         5346  33
33  20210202   賣權  202102    16200          323  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-03 09:30:03.288389
today:20210203
queryday:20210202
enddate:2021-02-17
202102
   Twseclose
0      15760
14800 16600
        Date Type  Contract Strike Openinterest  id
0   20210203   買權  202102    14900          477   1
1   20210203   賣權  202102    14900         5627   2
2   20210203   買權  202102    15000          977   3
3   20210203   賣權  202102    15000         8427   4
4   20210203   買權  202102    15100          335   5
5   20210203   賣權  202102    15100         4437   6
6   20210203   買權  202102    15200         1815   7
7   20210203   賣權  202102    15200         4105   8
8   20210203   買權  202102    15300         1758   9
9   20210203   賣權  202102    15300         3846  10
10  20210203   買權  202102    15350            2  11
11  20210203   賣權  202102    15350          533  12
12  20210203   買權  202102    15400         3648  13
13  20210203   賣權  202102    15400         5321  14
14  20210203   買權  202102    15450           13  15
15  20210203   賣權  202102    15450          623  16
16  20210203   買權  202102    15500         1833  17
17  20210203   賣權  202102    15500         4253  18
18  20210203   買權  202102    15550           28  19
19  20210203   賣權  202102    15550          235  20
20  20210203   買權  202102    15600         2892  21
21  20210203   賣權  202102    15600         3189  22
22  20210203   買權  202102    15650           55  23
23  20210203   賣權  202102    15650          169  24
24  20210203   買權  202102    15700         4112  25
25  20210203   賣權  202102    15700         4014  26
26  20210203   買權  202102    15750          276  27
27  20210203   賣權  202102    15750          523  28
28  20210203   買權  202102    15800         7448  29
29  20210203   賣權  202102    15800         5689  30
30  20210203   買權  202102    15850          603  31
31  20210203   賣權  202102    15850          263  32
32  20210203   買權  202102    15900         5699  33
33  20210203   賣權  202102    15900         3025  34
34  20210203   買權  202102    15950          398  35
35  20210203   賣權  202102    15950           91  36
36  20210203   買權  202102    16000         9877  37
37  20210203   賣權  202102    16000         2052  38
38  20210203   買權  202102    16050          399  39
39  20210203   賣權  202102    16050           31  40
40  20210203   買權  202102    16100         5234  41
41  20210203   賣權  202102    16100         1439  42
42  20210203   買權  202102    16150          376  43
43  20210203   賣權  202102    16150            1  44
44  20210203   買權  202102    16200         6019  45
45  20210203   賣權  202102    16200          350  46
46  20210203   買權  202102    16300         5650  47
47  20210203   賣權  202102    16300          154  48
48  20210203   買權  202102    16400         6435  49
49  20210203   賣權  202102    16400           79  50
50  20210203   買權  202102    16500         5500  51
51  20210203   賣權  202102    16500           23  52
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-04 09:30:02.595003
today:20210204
queryday:20210203
enddate:2021-02-17
202102
   Twseclose
0      15771
14800 16600
        Date Type Contract Strike Openinterest  id
0   20210204   買權   202102  14900          472   1
1   20210204   賣權   202102  14900         8478   2
2   20210204   買權   202102  15000          972   3
3   20210204   賣權   202102  15000        11505   4
4   20210204   買權   202102  15100          292   5
5   20210204   賣權   202102  15100         6445   6
6   20210204   買權   202102  15200         1763   7
7   20210204   賣權   202102  15200         6316   8
8   20210204   買權   202102  15300         1735   9
9   20210204   賣權   202102  15300         6737  10
10  20210204   買權   202102  15350           10  11
11  20210204   賣權   202102  15350         1989  12
12  20210204   買權   202102  15400         3536  13
13  20210204   賣權   202102  15400         6543  14
14  20210204   買權   202102  15450           32  15
15  20210204   賣權   202102  15450          834  16
16  20210204   買權   202102  15500         2033  17
17  20210204   賣權   202102  15500         4773  18
18  20210204   買權   202102  15550          174  19
19  20210204   賣權   202102  15550         1818  20
20  20210204   買權   202102  15600         2764  21
21  20210204   賣權   202102  15600         5171  22
22  20210204   買權   202102  15650          683  23
23  20210204   賣權   202102  15650         1623  24
24  20210204   買權   202102  15700         4383  25
25  20210204   賣權   202102  15700         4813  26
26  20210204   買權   202102  15750         1959  27
27  20210204   賣權   202102  15750         1129  28
28  20210204   買權   202102  15800         7663  29
29  20210204   賣權   202102  15800         5782  30
30  20210204   買權   202102  15850         1675  31
31  20210204   賣權   202102  15850         1099  32
32  20210204   買權   202102  15900         5546  33
33  20210204   賣權   202102  15900         3497  34
34  20210204   買權   202102  15950         1368  35
35  20210204   賣權   202102  15950          115  36
36  20210204   買權   202102  16000        11769  37
37  20210204   賣權   202102  16000         1984  38
38  20210204   買權   202102  16050         1764  39
39  20210204   賣權   202102  16050           47  40
40  20210204   買權   202102  16100         7433  41
41  20210204   賣權   202102  16100         1452  42
42  20210204   買權   202102  16150         1757  43
43  20210204   賣權   202102  16150           15  44
44  20210204   買權   202102  16200        10542  45
45  20210204   賣權   202102  16200          319  46
46  20210204   買權   202102  16300         8972  47
47  20210204   賣權   202102  16300          143  48
48  20210204   買權   202102  16400         9412  49
49  20210204   賣權   202102  16400           71  50
50  20210204   買權   202102  16500         8919  51
51  20210204   賣權   202102  16500           36  52
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-05 09:30:02.763043
today:20210205
queryday:20210204
enddate:2021-02-17
202102
   Twseclose
0      15706
14800 16600
        Date Type Contract Strike Openinterest  id
0   20210205   買權   202102  14900          467   1
1   20210205   賣權   202102  14900         9632   2
2   20210205   買權   202102  15000          965   3
3   20210205   賣權   202102  15000        13688   4
4   20210205   買權   202102  15100          282   5
5   20210205   賣權   202102  15100         9802   6
6   20210205   買權   202102  15200         1749   7
7   20210205   賣權   202102  15200         8209   8
8   20210205   買權   202102  15250            0   9
9   20210205   賣權   202102  15250         1725  10
10  20210205   買權   202102  15300         1677  11
11  20210205   賣權   202102  15300         8585  12
12  20210205   買權   202102  15350           11  13
13  20210205   賣權   202102  15350         3867  14
14  20210205   買權   202102  15400         3500  15
15  20210205   賣權   202102  15400         7340  16
16  20210205   買權   202102  15450           60  17
17  20210205   賣權   202102  15450         1841  18
18  20210205   買權   202102  15500         1795  19
19  20210205   賣權   202102  15500         6201  20
20  20210205   買權   202102  15550          225  21
21  20210205   賣權   202102  15550         1373  22
22  20210205   買權   202102  15600         2555  23
23  20210205   賣權   202102  15600         5631  24
24  20210205   買權   202102  15650          397  25
25  20210205   賣權   202102  15650         2026  26
26  20210205   買權   202102  15700         3679  27
27  20210205   賣權   202102  15700         5441  28
28  20210205   買權   202102  15750         1466  29
29  20210205   賣權   202102  15750         2106  30
30  20210205   買權   202102  15800         7498  31
31  20210205   賣權   202102  15800         8208  32
32  20210205   買權   202102  15850         2497  33
33  20210205   賣權   202102  15850         1663  34
34  20210205   買權   202102  15900         5522  35
35  20210205   賣權   202102  15900         3478  36
36  20210205   買權   202102  15950         2079  37
37  20210205   賣權   202102  15950          441  38
38  20210205   買權   202102  16000        11081  39
39  20210205   賣權   202102  16000         2763  40
40  20210205   買權   202102  16050         2693  41
41  20210205   賣權   202102  16050          159  42
42  20210205   買權   202102  16100         7725  43
43  20210205   賣權   202102  16100         1569  44
44  20210205   買權   202102  16150         2896  45
45  20210205   賣權   202102  16150           42  46
46  20210205   買權   202102  16200        10265  47
47  20210205   賣權   202102  16200          351  48
48  20210205   買權   202102  16300         9296  49
49  20210205   賣權   202102  16300          161  50
50  20210205   買權   202102  16400        10886  51
51  20210205   賣權   202102  16400           74  52
52  20210205   買權   202102  16500        12050  53
53  20210205   賣權   202102  16500           36  54
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-08 09:30:02.552611
today:20210208
queryday:20210205
enddate:2021-02-17
202102
   Twseclose
0      15802
14900 16700
Empty DataFrame
Columns: [Date, Type, Contract, Strike, Openinterest, id]
Index: []
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id              object
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id              object
dtype: object
now:2021-02-09 09:30:02.888771
today:20210209
queryday:20210208
enddate:2021-02-17
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-10 09:30:02.649906
today:20210210
queryday:20210209
enddate:2021-02-17
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-11 09:30:03.285885
today:20210211
queryday:20210210
enddate:2021-02-17
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-12 09:30:02.509257
today:20210212
queryday:20210211
enddate:2021-02-17
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-15 09:30:03.501511
today:20210215
queryday:20210212
enddate:2021-02-17
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-16 09:30:03.056788
today:20210216
queryday:20210215
enddate:2021-02-17
202102
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-17 09:30:02.615482
today:20210217
queryday:20210216
enddate:2021-02-17
202103
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-02-18 09:30:03.078006
today:20210218
queryday:20210217
enddate:2021-02-17
202103
   Twseclose
0      16362
15400 17200
        Date Type  Contract Strike Openinterest  id
0   20210218   買權  202103    15500          321   1
1   20210218   賣權  202103    15500         3814   2
2   20210218   買權  202103    15600          645   3
3   20210218   賣權  202103    15600         1963   4
4   20210218   買權  202103    15700         1961   5
5   20210218   賣權  202103    15700         1371   6
6   20210218   買權  202103    15800         1324   7
7   20210218   賣權  202103    15800         1716   8
8   20210218   買權  202103    15900         1119   9
9   20210218   賣權  202103    15900         1033  10
10  20210218   買權  202103    16000         1251  11
11  20210218   賣權  202103    16000         1093  12
12  20210218   買權  202103    16100          742  13
13  20210218   賣權  202103    16100         1034  14
14  20210218   買權  202103    16200         1340  15
15  20210218   賣權  202103    16200         1148  16
16  20210218   買權  202103    16300         1552  17
17  20210218   賣權  202103    16300         1496  18
18  20210218   買權  202103    16400         3108  19
19  20210218   賣權  202103    16400          500  20
20  20210218   買權  202103    16500         1993  21
21  20210218   賣權  202103    16500          606  22
22  20210218   買權  202103    16600         2131  23
23  20210218   賣權  202103    16600           86  24
24  20210218   買權  202103    16700         1340  25
25  20210218   賣權  202103    16700           74  26
26  20210218   買權  202103    16800         5690  27
27  20210218   賣權  202103    16800           16  28
28  20210218   買權  202103    16900         1777  29
29  20210218   賣權  202103    16900            3  30
30  20210218   買權  202103    17000         7533  31
31  20210218   賣權  202103    17000          134  32
32  20210218   買權  202103    17100         1627  33
33  20210218   賣權  202103    17100            0  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-19 09:30:03.142096
today:20210219
queryday:20210218
enddate:2021-02-17
202103
   Twseclose
0      16424
15500 17300
        Date Type  Contract Strike Openinterest  id
0   20210219   買權  202103    15600          642   1
1   20210219   賣權  202103    15600         2433   2
2   20210219   買權  202103    15700         2253   3
3   20210219   賣權  202103    15700         2931   4
4   20210219   買權  202103    15800         1856   5
5   20210219   賣權  202103    15800         1781   6
6   20210219   買權  202103    15900         1117   7
7   20210219   賣權  202103    15900         1249   8
8   20210219   買權  202103    16000         1382   9
9   20210219   賣權  202103    16000         1296  10
10  20210219   買權  202103    16100          802  11
11  20210219   賣權  202103    16100         1100  12
12  20210219   買權  202103    16200         1726  13
13  20210219   賣權  202103    16200         1453  14
14  20210219   買權  202103    16300         1838  15
15  20210219   賣權  202103    16300         1494  16
16  20210219   買權  202103    16400         5031  17
17  20210219   賣權  202103    16400          462  18
18  20210219   買權  202103    16500         2575  19
19  20210219   賣權  202103    16500          660  20
20  20210219   買權  202103    16600         2803  21
21  20210219   賣權  202103    16600           93  22
22  20210219   買權  202103    16700         1830  23
23  20210219   賣權  202103    16700           75  24
24  20210219   買權  202103    16800         5877  25
25  20210219   賣權  202103    16800           18  26
26  20210219   買權  202103    16900         2088  27
27  20210219   賣權  202103    16900           12  28
28  20210219   買權  202103    17000         7799  29
29  20210219   賣權  202103    17000          141  30
30  20210219   買權  202103    17100         2216  31
31  20210219   賣權  202103    17100            0  32
32  20210219   買權  202103    17200         1948  33
33  20210219   賣權  202103    17200            3  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-22 09:30:03.177154
today:20210222
queryday:20210219
enddate:2021-02-17
202103
   Twseclose
0      16341
15400 17200
        Date Type  Contract Strike Openinterest  id
0   20210222   買權  202103    15500          318   1
1   20210222   賣權  202103    15500         3561   2
2   20210222   買權  202103    15600          624   3
3   20210222   賣權  202103    15600         5222   4
4   20210222   買權  202103    15700         2231   5
5   20210222   賣權  202103    15700         3226   6
6   20210222   買權  202103    15800         1671   7
7   20210222   賣權  202103    15800         1991   8
8   20210222   買權  202103    15900          975   9
9   20210222   賣權  202103    15900         1309  10
10  20210222   買權  202103    16000         1264  11
11  20210222   賣權  202103    16000         2604  12
12  20210222   買權  202103    16100          754  13
13  20210222   賣權  202103    16100         2774  14
14  20210222   買權  202103    16200         1430  15
15  20210222   賣權  202103    16200         3357  16
16  20210222   買權  202103    16300         1831  17
17  20210222   賣權  202103    16300         1644  18
18  20210222   買權  202103    16400         4392  19
19  20210222   賣權  202103    16400         1457  20
20  20210222   買權  202103    16500         2374  21
21  20210222   賣權  202103    16500          623  22
22  20210222   買權  202103    16600         2754  23
23  20210222   賣權  202103    16600          142  24
24  20210222   買權  202103    16700         1869  25
25  20210222   賣權  202103    16700          167  26
26  20210222   買權  202103    16800         6070  27
27  20210222   賣權  202103    16800           56  28
28  20210222   買權  202103    16900         2322  29
29  20210222   賣權  202103    16900           36  30
30  20210222   買權  202103    17000         8164  31
31  20210222   賣權  202103    17000          156  32
32  20210222   買權  202103    17100         2525  33
33  20210222   賣權  202103    17100           17  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-23 09:30:02.638702
today:20210223
queryday:20210222
enddate:2021-02-17
202103
   Twseclose
0      16410
15500 17300
        Date Type  Contract Strike Openinterest  id
0   20210223   買權  202103    15600          621   1
1   20210223   賣權  202103    15600         6073   2
2   20210223   買權  202103    15700         2370   3
3   20210223   賣權  202103    15700         3618   4
4   20210223   買權  202103    15800         1688   5
5   20210223   賣權  202103    15800         2558   6
6   20210223   買權  202103    15900          945   7
7   20210223   賣權  202103    15900         1105   8
8   20210223   買權  202103    16000         1199   9
9   20210223   賣權  202103    16000         2736  10
10  20210223   買權  202103    16100          753  11
11  20210223   賣權  202103    16100         2731  12
12  20210223   買權  202103    16200         1995  13
13  20210223   賣權  202103    16200         3719  14
14  20210223   買權  202103    16300         2290  15
15  20210223   賣權  202103    16300         3083  16
16  20210223   買權  202103    16400         4681  17
17  20210223   賣權  202103    16400         1280  18
18  20210223   買權  202103    16500         4018  19
19  20210223   賣權  202103    16500          759  20
20  20210223   買權  202103    16600         2998  21
21  20210223   賣權  202103    16600          166  22
22  20210223   買權  202103    16700         2108  23
23  20210223   賣權  202103    16700          181  24
24  20210223   買權  202103    16800         6484  25
25  20210223   賣權  202103    16800           74  26
26  20210223   買權  202103    16900         2468  27
27  20210223   賣權  202103    16900           57  28
28  20210223   買權  202103    17000         8788  29
29  20210223   賣權  202103    17000          184  30
30  20210223   買權  202103    17100         3188  31
31  20210223   賣權  202103    17100          155  32
32  20210223   買權  202103    17200         2763  33
33  20210223   賣權  202103    17200           36  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-24 09:30:02.998322
today:20210224
queryday:20210223
enddate:2021-02-17
202103
   Twseclose
0      16443
15500 17300
        Date Type  Contract Strike Openinterest  id
0   20210224   買權  202103    15600          619   1
1   20210224   賣權  202103    15600         8837   2
2   20210224   買權  202103    15700         2532   3
3   20210224   賣權  202103    15700         5051   4
4   20210224   買權  202103    15800         1899   5
5   20210224   賣權  202103    15800         2580   6
6   20210224   買權  202103    15900          957   7
7   20210224   賣權  202103    15900         1183   8
8   20210224   買權  202103    16000         1274   9
9   20210224   賣權  202103    16000         2978  10
10  20210224   買權  202103    16100          739  11
11  20210224   賣權  202103    16100         2784  12
12  20210224   買權  202103    16200         2167  13
13  20210224   賣權  202103    16200         4210  14
14  20210224   買權  202103    16300         3065  15
15  20210224   賣權  202103    16300         3108  16
16  20210224   買權  202103    16400         5372  17
17  20210224   賣權  202103    16400         1470  18
18  20210224   買權  202103    16500         4073  19
19  20210224   賣權  202103    16500          746  20
20  20210224   買權  202103    16600         3674  21
21  20210224   賣權  202103    16600          187  22
22  20210224   買權  202103    16700         2359  23
23  20210224   賣權  202103    16700          142  24
24  20210224   買權  202103    16800         6920  25
25  20210224   賣權  202103    16800           79  26
26  20210224   買權  202103    16900         2882  27
27  20210224   賣權  202103    16900           57  28
28  20210224   買權  202103    17000         9773  29
29  20210224   賣權  202103    17000          181  30
30  20210224   買權  202103    17100         3244  31
31  20210224   賣權  202103    17100          151  32
32  20210224   買權  202103    17200         3521  33
33  20210224   賣權  202103    17200           35  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-25 09:30:02.450747
today:20210225
queryday:20210224
enddate:2021-02-17
202103
   Twseclose
0      16212
15300 17100
        Date Type  Contract Strike Openinterest  id
0   20210225   買權  202103    15400          533   1
1   20210225   賣權  202103    15400         3908   2
2   20210225   買權  202103    15500          321   3
3   20210225   賣權  202103    15500         3809   4
4   20210225   買權  202103    15600          619   5
5   20210225   賣權  202103    15600        10177   6
6   20210225   買權  202103    15700         2523   7
7   20210225   賣權  202103    15700         5121   8
8   20210225   買權  202103    15800         1901   9
9   20210225   賣權  202103    15800         2853  10
10  20210225   買權  202103    15900          961  11
11  20210225   賣權  202103    15900         1563  12
12  20210225   買權  202103    16000         1245  13
13  20210225   賣權  202103    16000         3148  14
14  20210225   買權  202103    16100          711  15
15  20210225   賣權  202103    16100         2849  16
16  20210225   買權  202103    16200         2368  17
17  20210225   賣權  202103    16200         4224  18
18  20210225   買權  202103    16300         2718  19
19  20210225   賣權  202103    16300         3571  20
20  20210225   買權  202103    16400         5796  21
21  20210225   賣權  202103    16400         1645  22
22  20210225   買權  202103    16500         3840  23
23  20210225   賣權  202103    16500          965  24
24  20210225   買權  202103    16600         3945  25
25  20210225   賣權  202103    16600          258  26
26  20210225   買權  202103    16700         2257  27
27  20210225   賣權  202103    16700          175  28
28  20210225   買權  202103    16800         6348  29
29  20210225   賣權  202103    16800          136  30
30  20210225   買權  202103    16900         2902  31
31  20210225   賣權  202103    16900           57  32
32  20210225   買權  202103    17000        10340  33
33  20210225   賣權  202103    17000          389  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-02-26 09:30:03.106967
today:20210226
queryday:20210225
enddate:2021-02-17
202103
   Twseclose
0      16452
15500 17300
        Date Type  Contract Strike Openinterest  id
0   20210226   買權  202103    15600          622   1
1   20210226   賣權  202103    15600        10211   2
2   20210226   買權  202103    15700         2812   3
3   20210226   賣權  202103    15700         4087   4
4   20210226   買權  202103    15800         2179   5
5   20210226   賣權  202103    15800         3104   6
6   20210226   買權  202103    15900         1218   7
7   20210226   賣權  202103    15900         2039   8
8   20210226   買權  202103    16000         2003   9
9   20210226   賣權  202103    16000         3128  10
10  20210226   買權  202103    16100         1347  11
11  20210226   賣權  202103    16100         2697  12
12  20210226   買權  202103    16200         2443  13
13  20210226   賣權  202103    16200         3979  14
14  20210226   買權  202103    16300         3424  15
15  20210226   賣權  202103    16300         3420  16
16  20210226   買權  202103    16400         7242  17
17  20210226   賣權  202103    16400         1474  18
18  20210226   買權  202103    16500         4418  19
19  20210226   賣權  202103    16500          849  20
20  20210226   買權  202103    16600         4825  21
21  20210226   賣權  202103    16600          181  22
22  20210226   買權  202103    16700         2659  23
23  20210226   賣權  202103    16700          162  24
24  20210226   買權  202103    16800         6958  25
25  20210226   賣權  202103    16800          135  26
26  20210226   買權  202103    16900         3731  27
27  20210226   賣權  202103    16900           60  28
28  20210226   買權  202103    17000        11062  29
29  20210226   賣權  202103    17000          366  30
30  20210226   買權  202103    17100         3591  31
31  20210226   賣權  202103    17100          183  32
32  20210226   買權  202103    17200         5088  33
33  20210226   賣權  202103    17200          122  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-01 09:30:03.480949
today:20210301
queryday:20210226
enddate:2021-03-17
202103
   Twseclose
0      15953
15000 16800
Empty DataFrame
Columns: [Date, Type, Contract, Strike, Openinterest, id]
Index: []
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id              object
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id              object
dtype: object
now:2021-03-02 09:30:02.575680
today:20210302
queryday:20210301
enddate:2021-03-17
202103
Empty DataFrame
Columns: [Twseclose]
Index: []
Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 98, in <module>
    lower=math.floor(generator_df.iloc[0][0]/100-9)*100
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1767, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2137, in _getitem_axis
    self._validate_integer(key, axis)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 2062, in _validate_integer
    raise IndexError("single positional indexer is out-of-bounds")
IndexError: single positional indexer is out-of-bounds
now:2021-03-03 09:30:02.424069
today:20210303
queryday:20210302
enddate:2021-03-17
202103
   Twseclose
0      15946
15000 16800
        Date Type  Contract Strike Openinterest  id
0   20210303   買權  202103    15100           29   1
1   20210303   賣權  202103    15100         4012   2
2   20210303   買權  202103    15200          775   3
3   20210303   賣權  202103    15200         6332   4
4   20210303   買權  202103    15300          127   5
5   20210303   賣權  202103    15300         4372   6
6   20210303   買權  202103    15400          591   7
7   20210303   賣權  202103    15400         4515   8
8   20210303   買權  202103    15500          313   9
9   20210303   賣權  202103    15500         4154  10
10  20210303   買權  202103    15600          652  11
11  20210303   賣權  202103    15600        10175  12
12  20210303   買權  202103    15700         2891  13
13  20210303   賣權  202103    15700         5280  14
14  20210303   買權  202103    15800         2200  15
15  20210303   賣權  202103    15800         4018  16
16  20210303   買權  202103    15900         1297  17
17  20210303   賣權  202103    15900         2226  18
18  20210303   買權  202103    16000         3178  19
19  20210303   賣權  202103    16000         3896  20
20  20210303   買權  202103    16100         1689  21
21  20210303   賣權  202103    16100         2916  22
22  20210303   買權  202103    16200         2823  23
23  20210303   賣權  202103    16200         3995  24
24  20210303   買權  202103    16300         4958  25
25  20210303   賣權  202103    16300         2990  26
26  20210303   買權  202103    16400         6795  27
27  20210303   賣權  202103    16400         1736  28
28  20210303   買權  202103    16500         5280  29
29  20210303   賣權  202103    16500          771  30
30  20210303   買權  202103    16600         6334  31
31  20210303   賣權  202103    16600          208  32
32  20210303   買權  202103    16700         4314  33
33  20210303   賣權  202103    16700          155  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-04 09:30:02.648606
today:20210304
queryday:20210303
enddate:2021-03-17
202103
   Twseclose
0      16211
15300 17100
        Date Type  Contract Strike Openinterest  id
0   20210304   買權  202103    15400          592   1
1   20210304   賣權  202103    15400         4722   2
2   20210304   買權  202103    15500          352   3
3   20210304   賣權  202103    15500         4203   4
4   20210304   買權  202103    15600          721   5
5   20210304   賣權  202103    15600         9964   6
6   20210304   買權  202103    15700         2965   7
7   20210304   賣權  202103    15700         4560   8
8   20210304   買權  202103    15800         2342   9
9   20210304   賣權  202103    15800         4250  10
10  20210304   買權  202103    15900         1931  11
11  20210304   賣權  202103    15900         2020  12
12  20210304   買權  202103    16000         4297  13
13  20210304   賣權  202103    16000         3365  14
14  20210304   買權  202103    16100         2252  15
15  20210304   賣權  202103    16100         2780  16
16  20210304   買權  202103    16200         3631  17
17  20210304   賣權  202103    16200         3821  18
18  20210304   買權  202103    16300         6087  19
19  20210304   賣權  202103    16300         2884  20
20  20210304   買權  202103    16400         6889  21
21  20210304   賣權  202103    16400         1644  22
22  20210304   買權  202103    16500         5657  23
23  20210304   賣權  202103    16500          709  24
24  20210304   買權  202103    16600         7080  25
25  20210304   賣權  202103    16600          175  26
26  20210304   買權  202103    16700         4036  27
27  20210304   賣權  202103    16700          105  28
28  20210304   買權  202103    16800         7743  29
29  20210304   賣權  202103    16800          135  30
30  20210304   買權  202103    16900         4148  31
31  20210304   賣權  202103    16900           78  32
32  20210304   買權  202103    17000        14042  33
33  20210304   賣權  202103    17000          366  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-05 09:30:02.593692
today:20210305
queryday:20210304
enddate:2021-03-17
202103
   Twseclose
0      15906
15000 16800
        Date Type  Contract Strike Openinterest  id
0   20210305   買權  202103    15100           29   1
1   20210305   賣權  202103    15100         4163   2
2   20210305   買權  202103    15200          780   3
3   20210305   賣權  202103    15200         5639   4
4   20210305   買權  202103    15300           98   5
5   20210305   賣權  202103    15300         4501   6
6   20210305   買權  202103    15400          650   7
7   20210305   賣權  202103    15400         5683   8
8   20210305   買權  202103    15500          464   9
9   20210305   賣權  202103    15500         5623  10
10  20210305   買權  202103    15600          952  11
11  20210305   賣權  202103    15600        10324  12
12  20210305   買權  202103    15700         3090  13
13  20210305   賣權  202103    15700         4446  14
14  20210305   買權  202103    15800         2619  15
15  20210305   賣權  202103    15800         4782  16
16  20210305   買權  202103    15900         2484  17
17  20210305   賣權  202103    15900         1942  18
18  20210305   買權  202103    16000         4503  19
19  20210305   賣權  202103    16000         3430  20
20  20210305   買權  202103    16100         2986  21
21  20210305   賣權  202103    16100         2739  22
22  20210305   買權  202103    16200         5033  23
23  20210305   賣權  202103    16200         3764  24
24  20210305   買權  202103    16300         6961  25
25  20210305   賣權  202103    16300         2854  26
26  20210305   買權  202103    16400         7812  27
27  20210305   賣權  202103    16400         1599  28
28  20210305   買權  202103    16500         5867  29
29  20210305   賣權  202103    16500          679  30
30  20210305   買權  202103    16600         6881  31
31  20210305   賣權  202103    16600          174  32
32  20210305   買權  202103    16700         4037  33
33  20210305   賣權  202103    16700          103  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-08 09:30:02.703716
today:20210308
queryday:20210305
enddate:2021-03-17
202103
   Twseclose
0      15855
14900 16700
        Date Type  Contract Strike Openinterest  id
0   20210308   買權  202103    15000          660   1
1   20210308   賣權  202103    15000        10222   2
2   20210308   買權  202103    15100           28   3
3   20210308   賣權  202103    15100         3849   4
4   20210308   買權  202103    15200          781   5
5   20210308   賣權  202103    15200         5603   6
6   20210308   買權  202103    15300           95   7
7   20210308   賣權  202103    15300         4622   8
8   20210308   買權  202103    15400          649   9
9   20210308   賣權  202103    15400         4998  10
10  20210308   買權  202103    15500          471  11
11  20210308   賣權  202103    15500         4891  12
12  20210308   買權  202103    15600          926  13
13  20210308   賣權  202103    15600        10490  14
14  20210308   買權  202103    15700         3163  15
15  20210308   賣權  202103    15700         4677  16
16  20210308   買權  202103    15800         2862  17
17  20210308   賣權  202103    15800         4264  18
18  20210308   買權  202103    15900         2904  19
19  20210308   賣權  202103    15900         1885  20
20  20210308   買權  202103    16000         5167  21
21  20210308   賣權  202103    16000         3376  22
22  20210308   買權  202103    16100         3186  23
23  20210308   賣權  202103    16100         2779  24
24  20210308   買權  202103    16200         5113  25
25  20210308   賣權  202103    16200         3769  26
26  20210308   買權  202103    16300         8599  27
27  20210308   賣權  202103    16300         2859  28
28  20210308   買權  202103    16400         8979  29
29  20210308   賣權  202103    16400         1591  30
30  20210308   買權  202103    16500         6980  31
31  20210308   賣權  202103    16500          672  32
32  20210308   買權  202103    16600         8032  33
33  20210308   賣權  202103    16600          180  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-09 09:30:03.092195
today:20210309
queryday:20210308
enddate:2021-03-17
202103
   Twseclose
0      15820
14900 16700
        Date Type  Contract Strike Openinterest  id
0   20210309   買權  202103    15000          660   1
1   20210309   賣權  202103    15000        10262   2
2   20210309   買權  202103    15100           27   3
3   20210309   賣權  202103    15100         3780   4
4   20210309   買權  202103    15200          803   5
5   20210309   賣權  202103    15200         6180   6
6   20210309   買權  202103    15300          103   7
7   20210309   賣權  202103    15300         5331   8
8   20210309   買權  202103    15400          667   9
9   20210309   賣權  202103    15400         8323  10
10  20210309   買權  202103    15500          457  11
11  20210309   賣權  202103    15500         4880  12
12  20210309   買權  202103    15600         1063  13
13  20210309   賣權  202103    15600        10321  14
14  20210309   買權  202103    15700         3218  15
15  20210309   賣權  202103    15700         4763  16
16  20210309   買權  202103    15800         4079  17
17  20210309   賣權  202103    15800         4527  18
18  20210309   買權  202103    15900         3348  19
19  20210309   賣權  202103    15900         1782  20
20  20210309   買權  202103    16000         6742  21
21  20210309   賣權  202103    16000         3463  22
22  20210309   買權  202103    16100         4510  23
23  20210309   賣權  202103    16100         2726  24
24  20210309   買權  202103    16200         6408  25
25  20210309   賣權  202103    16200         3755  26
26  20210309   買權  202103    16300         8054  27
27  20210309   賣權  202103    16300         2840  28
28  20210309   買權  202103    16400         9196  29
29  20210309   賣權  202103    16400         1592  30
30  20210309   買權  202103    16500         7770  31
31  20210309   賣權  202103    16500          666  32
32  20210309   買權  202103    16600         8613  33
33  20210309   賣權  202103    16600          171  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-10 09:30:02.912661
today:20210310
queryday:20210309
enddate:2021-03-17
202103
   Twseclose
0      15853
14900 16700
        Date Type  Contract Strike Openinterest  id
0   20210310   買權  202103    15000          660   1
1   20210310   賣權  202103    15000        11492   2
2   20210310   買權  202103    15100           30   3
3   20210310   賣權  202103    15100         5062   4
4   20210310   買權  202103    15200          807   5
5   20210310   賣權  202103    15200         7088   6
6   20210310   買權  202103    15300           94   7
7   20210310   賣權  202103    15300         6695   8
8   20210310   買權  202103    15400          647   9
9   20210310   賣權  202103    15400         9984  10
10  20210310   買權  202103    15450           84  11
11  20210310   賣權  202103    15450         1603  12
12  20210310   買權  202103    15500          454  13
13  20210310   賣權  202103    15500         7151  14
14  20210310   買權  202103    15550            5  15
15  20210310   賣權  202103    15550          623  16
16  20210310   買權  202103    15600         1088  17
17  20210310   賣權  202103    15600        11589  18
18  20210310   買權  202103    15650           19  19
19  20210310   賣權  202103    15650          629  20
20  20210310   買權  202103    15700         3164  21
21  20210310   賣權  202103    15700         5504  22
22  20210310   買權  202103    15750           80  23
23  20210310   賣權  202103    15750          777  24
24  20210310   買權  202103    15800         5365  25
25  20210310   賣權  202103    15800         5090  26
26  20210310   買權  202103    15850          294  27
27  20210310   賣權  202103    15850          590  28
28  20210310   買權  202103    15900         4348  29
29  20210310   賣權  202103    15900         2969  30
30  20210310   買權  202103    15950         1066  31
31  20210310   賣權  202103    15950          298  32
32  20210310   買權  202103    16000         6743  33
33  20210310   賣權  202103    16000         3727  34
34  20210310   買權  202103    16050         1119  35
35  20210310   賣權  202103    16050           45  36
36  20210310   買權  202103    16100         5349  37
37  20210310   賣權  202103    16100         2748  38
38  20210310   買權  202103    16150         1378  39
39  20210310   賣權  202103    16150          137  40
40  20210310   買權  202103    16200         7857  41
41  20210310   賣權  202103    16200         3813  42
42  20210310   買權  202103    16250         1797  43
43  20210310   賣權  202103    16250           19  44
44  20210310   買權  202103    16300        11481  45
45  20210310   賣權  202103    16300         2843  46
46  20210310   買權  202103    16400        13309  47
47  20210310   賣權  202103    16400         1579  48
48  20210310   買權  202103    16500        11601  49
49  20210310   賣權  202103    16500          650  50
50  20210310   買權  202103    16600         9984  51
51  20210310   賣權  202103    16600          171  52
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-11 09:30:02.910373
today:20210311
queryday:20210310
enddate:2021-03-17
202103
   Twseclose
0      15911
15000 16800
        Date Type Contract Strike Openinterest  id
0   20210311   買權   202103  15100           28   1
1   20210311   賣權   202103  15100         5940   2
2   20210311   買權   202103  15200          795   3
3   20210311   賣權   202103  15200         7287   4
4   20210311   買權   202103  15300           85   5
5   20210311   賣權   202103  15300        10958   6
6   20210311   買權   202103  15400          613   7
7   20210311   賣權   202103  15400        12666   8
8   20210311   買權   202103  15450           93   9
9   20210311   賣權   202103  15450         3591  10
10  20210311   買權   202103  15500          421  11
11  20210311   賣權   202103  15500        10870  12
12  20210311   買權   202103  15550           12  13
13  20210311   賣權   202103  15550         3307  14
14  20210311   買權   202103  15600          987  15
15  20210311   賣權   202103  15600        14619  16
16  20210311   買權   202103  15650           20  17
17  20210311   賣權   202103  15650         2862  18
18  20210311   買權   202103  15700         3058  19
19  20210311   賣權   202103  15700        10021  20
20  20210311   買權   202103  15750          164  21
21  20210311   賣權   202103  15750         3064  22
22  20210311   買權   202103  15800         5349  23
23  20210311   賣權   202103  15800        10705  24
24  20210311   買權   202103  15850          336  25
25  20210311   賣權   202103  15850         3993  26
26  20210311   買權   202103  15900         3945  27
27  20210311   賣權   202103  15900         6576  28
28  20210311   買權   202103  15950          847  29
29  20210311   賣權   202103  15950         2831  30
30  20210311   買權   202103  16000         7229  31
31  20210311   賣權   202103  16000         8049  32
32  20210311   買權   202103  16050         1600  33
33  20210311   賣權   202103  16050         1585  34
34  20210311   買權   202103  16100         5124  35
35  20210311   賣權   202103  16100         4437  36
36  20210311   買權   202103  16150         2009  37
37  20210311   賣權   202103  16150         1271  38
38  20210311   買權   202103  16200         8234  39
39  20210311   賣權   202103  16200         4811  40
40  20210311   買權   202103  16250         3073  41
41  20210311   賣權   202103  16250          298  42
42  20210311   買權   202103  16300        12369  43
43  20210311   賣權   202103  16300         2935  44
44  20210311   買權   202103  16350         2522  45
45  20210311   賣權   202103  16350          147  46
46  20210311   買權   202103  16400        16107  47
47  20210311   賣權   202103  16400         1536  48
48  20210311   買權   202103  16500        15203  49
49  20210311   賣權   202103  16500          686  50
50  20210311   買權   202103  16600        13796  51
51  20210311   賣權   202103  16600          206  52
52  20210311   買權   202103  16700        10986  53
53  20210311   賣權   202103  16700           92  54
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-12 09:30:03.268865
today:20210312
queryday:20210311
enddate:2021-03-17
202103
   Twseclose
0      16179
15200 17000
        Date Type Contract Strike Openinterest  id
0   20210312   買權   202103  15300           85   1
1   20210312   賣權   202103  15300         8327   2
2   20210312   買權   202103  15400          604   3
3   20210312   賣權   202103  15400        11128   4
4   20210312   買權   202103  15450           93   5
5   20210312   賣權   202103  15450         4422   6
6   20210312   買權   202103  15500          414   7
7   20210312   賣權   202103  15500         9118   8
8   20210312   買權   202103  15550           15   9
9   20210312   賣權   202103  15550         4959  10
10  20210312   買權   202103  15600          892  11
11  20210312   賣權   202103  15600        16269  12
12  20210312   買權   202103  15650           19  13
13  20210312   賣權   202103  15650         2824  14
14  20210312   買權   202103  15700         2927  15
15  20210312   賣權   202103  15700        11237  16
16  20210312   買權   202103  15750          142  17
17  20210312   賣權   202103  15750         3897  18
18  20210312   買權   202103  15800         5106  19
19  20210312   賣權   202103  15800        14787  20
20  20210312   買權   202103  15850          324  21
21  20210312   賣權   202103  15850         6685  22
22  20210312   買權   202103  15900         3602  23
23  20210312   賣權   202103  15900         8831  24
24  20210312   買權   202103  15950          666  25
25  20210312   賣權   202103  15950         4189  26
26  20210312   買權   202103  16000         6592  27
27  20210312   賣權   202103  16000        10293  28
28  20210312   買權   202103  16050         1503  29
29  20210312   賣權   202103  16050         2995  30
30  20210312   買權   202103  16100         5038  31
31  20210312   賣權   202103  16100         5864  32
32  20210312   買權   202103  16150         2150  33
33  20210312   賣權   202103  16150         2237  34
34  20210312   買權   202103  16200         8295  35
35  20210312   賣權   202103  16200         6850  36
36  20210312   買權   202103  16250         3358  37
37  20210312   賣權   202103  16250         1261  38
38  20210312   買權   202103  16300        12565  39
39  20210312   賣權   202103  16300         3335  40
40  20210312   買權   202103  16350         4485  41
41  20210312   賣權   202103  16350          437  42
42  20210312   買權   202103  16400        17804  43
43  20210312   賣權   202103  16400         1503  44
44  20210312   買權   202103  16450         2152  45
45  20210312   賣權   202103  16450          126  46
46  20210312   買權   202103  16500        21121  47
47  20210312   賣權   202103  16500          771  48
48  20210312   買權   202103  16550         2484  49
49  20210312   賣權   202103  16550           18  50
50  20210312   買權   202103  16600        16325  51
51  20210312   賣權   202103  16600          226  52
52  20210312   買權   202103  16650         4587  53
53  20210312   賣權   202103  16650            5  54
54  20210312   買權   202103  16700        16539  55
55  20210312   賣權   202103  16700           98  56
56  20210312   買權   202103  16800        13703  57
57  20210312   賣權   202103  16800          121  58
58  20210312   買權   202103  16900         9700  59
59  20210312   賣權   202103  16900           73  60
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-15 09:30:03.329020
today:20210315
queryday:20210312
enddate:2021-03-17
202103
   Twseclose
0      16255
15300 17100
        Date Type Contract Strike Openinterest  id
0   20210315   買權   202103  15400          603   1
1   20210315   賣權   202103  15400        10014   2
2   20210315   買權   202103  15450           93   3
3   20210315   賣權   202103  15450         3688   4
4   20210315   買權   202103  15500          408   5
5   20210315   賣權   202103  15500         8223   6
6   20210315   買權   202103  15550           12   7
7   20210315   賣權   202103  15550         5791   8
8   20210315   買權   202103  15600          854   9
9   20210315   賣權   202103  15600        15673  10
10  20210315   買權   202103  15650           20  11
11  20210315   賣權   202103  15650         4406  12
12  20210315   買權   202103  15700         2941  13
13  20210315   賣權   202103  15700        11722  14
14  20210315   買權   202103  15750          137  15
15  20210315   賣權   202103  15750         4949  16
16  20210315   買權   202103  15800         5184  17
17  20210315   賣權   202103  15800        14524  18
18  20210315   買權   202103  15850          261  19
19  20210315   賣權   202103  15850        10312  20
20  20210315   買權   202103  15900         3681  21
21  20210315   賣權   202103  15900        12909  22
22  20210315   買權   202103  15950          643  23
23  20210315   賣權   202103  15950         7774  24
24  20210315   買權   202103  16000         6398  25
25  20210315   賣權   202103  16000        12804  26
26  20210315   買權   202103  16050         1465  27
27  20210315   賣權   202103  16050         5493  28
28  20210315   買權   202103  16100         5376  29
29  20210315   賣權   202103  16100         8515  30
30  20210315   買權   202103  16150         2848  31
31  20210315   賣權   202103  16150         3259  32
32  20210315   買權   202103  16200        10354  33
33  20210315   賣權   202103  16200         8234  34
34  20210315   買權   202103  16250         5310  35
35  20210315   賣權   202103  16250         1889  36
36  20210315   買權   202103  16300        17075  37
37  20210315   賣權   202103  16300         3612  38
38  20210315   買權   202103  16350         6863  39
39  20210315   賣權   202103  16350          648  40
40  20210315   買權   202103  16400        18717  41
41  20210315   賣權   202103  16400         1661  42
42  20210315   買權   202103  16450         5081  43
43  20210315   賣權   202103  16450           63  44
44  20210315   買權   202103  16500        23236  45
45  20210315   賣權   202103  16500          826  46
46  20210315   買權   202103  16550         5535  47
47  20210315   賣權   202103  16550           56  48
48  20210315   買權   202103  16600        18784  49
49  20210315   賣權   202103  16600          232  50
50  20210315   買權   202103  16650         6632  51
51  20210315   賣權   202103  16650           10  52
52  20210315   買權   202103  16700        11745  53
53  20210315   賣權   202103  16700           94  54
54  20210315   買權   202103  16800        13673  55
55  20210315   賣權   202103  16800          120  56
56  20210315   買權   202103  16900         9461  57
57  20210315   賣權   202103  16900           73  58
58  20210315   買權   202103  17000        14571  59
59  20210315   賣權   202103  17000          365  60
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-16 09:30:03.813959
today:20210316
queryday:20210315
enddate:2021-03-17
202103
   Twseclose
0      16249
15300 17100
        Date Type Contract Strike Openinterest  id
0   20210316   買權   202103  15400          591   1
1   20210316   賣權   202103  15400         9555   2
2   20210316   買權   202103  15450           95   3
3   20210316   賣權   202103  15450         2912   4
4   20210316   買權   202103  15500          395   5
5   20210316   賣權   202103  15500         7361   6
6   20210316   買權   202103  15550           12   7
7   20210316   賣權   202103  15550         5260   8
8   20210316   買權   202103  15600          828   9
9   20210316   賣權   202103  15600        15905  10
10  20210316   買權   202103  15650           21  11
11  20210316   賣權   202103  15650         3746  12
12  20210316   買權   202103  15700         2903  13
13  20210316   賣權   202103  15700        10614  14
14  20210316   買權   202103  15750          129  15
15  20210316   賣權   202103  15750         4900  16
16  20210316   買權   202103  15800         5029  17
17  20210316   賣權   202103  15800        12118  18
18  20210316   買權   202103  15850          240  19
19  20210316   賣權   202103  15850        10063  20
20  20210316   買權   202103  15900         3337  21
21  20210316   賣權   202103  15900        12283  22
22  20210316   買權   202103  15950          603  23
23  20210316   賣權   202103  15950         5854  24
24  20210316   買權   202103  16000         5815  25
25  20210316   賣權   202103  16000        14025  26
26  20210316   買權   202103  16050         1525  27
27  20210316   賣權   202103  16050         6911  28
28  20210316   買權   202103  16100         4639  29
29  20210316   賣權   202103  16100        11583  30
30  20210316   買權   202103  16150         2455  31
31  20210316   賣權   202103  16150         7406  32
32  20210316   買權   202103  16200         8944  33
33  20210316   賣權   202103  16200        13016  34
34  20210316   買權   202103  16250         5537  35
35  20210316   賣權   202103  16250         5306  36
36  20210316   買權   202103  16300        15936  37
37  20210316   賣權   202103  16300         8109  38
38  20210316   買權   202103  16350         8723  39
39  20210316   賣權   202103  16350         2872  40
40  20210316   買權   202103  16400        19996  41
41  20210316   賣權   202103  16400         2614  42
42  20210316   買權   202103  16450        10306  43
43  20210316   賣權   202103  16450          368  44
44  20210316   買權   202103  16500        22144  45
45  20210316   賣權   202103  16500         1037  46
46  20210316   買權   202103  16550         6995  47
47  20210316   賣權   202103  16550           65  48
48  20210316   買權   202103  16600        15059  49
49  20210316   賣權   202103  16600          361  50
50  20210316   買權   202103  16650         7002  51
51  20210316   賣權   202103  16650           54  52
52  20210316   買權   202103  16700        11640  53
53  20210316   賣權   202103  16700          105  54
54  20210316   買權   202103  16800        13389  55
55  20210316   賣權   202103  16800          112  56
56  20210316   買權   202103  16900         9036  57
57  20210316   賣權   202103  16900           74  58
58  20210316   買權   202103  17000        14106  59
59  20210316   賣權   202103  17000          365  60
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-17 09:30:05.416232
today:20210317
queryday:20210316
enddate:2021-03-17
202104
   Twseclose
0      16313
15400 17200
        Date Type  Contract Strike Openinterest  id
0   20210317   買權  202104    15500           52   1
1   20210317   賣權  202104    15500         3317   2
2   20210317   買權  202104    15600          101   3
3   20210317   賣權  202104    15600         3459   4
4   20210317   買權  202104    15700          132   5
5   20210317   賣權  202104    15700         1117   6
6   20210317   買權  202104    15800          197   7
7   20210317   賣權  202104    15800         2141   8
8   20210317   買權  202104    15900          531   9
9   20210317   賣權  202104    15900         1665  10
10  20210317   買權  202104    16000         1232  11
11  20210317   賣權  202104    16000         2678  12
12  20210317   買權  202104    16100         1327  13
13  20210317   賣權  202104    16100         1716  14
14  20210317   買權  202104    16200         1395  15
15  20210317   賣權  202104    16200         1623  16
16  20210317   買權  202104    16300         2251  17
17  20210317   賣權  202104    16300          934  18
18  20210317   買權  202104    16400         1512  19
19  20210317   賣權  202104    16400          408  20
20  20210317   買權  202104    16500         2025  21
21  20210317   賣權  202104    16500           93  22
22  20210317   買權  202104    16600         1262  23
23  20210317   賣權  202104    16600           49  24
24  20210317   買權  202104    16700         2542  25
25  20210317   賣權  202104    16700           60  26
26  20210317   買權  202104    16800         3130  27
27  20210317   賣權  202104    16800           38  28
28  20210317   買權  202104    16900         1739  29
29  20210317   賣權  202104    16900           26  30
30  20210317   買權  202104    17000         4202  31
31  20210317   賣權  202104    17000           52  32
32  20210317   買權  202104    17100         2278  33
33  20210317   賣權  202104    17100            1  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-18 09:30:02.973913
today:20210318
queryday:20210317
enddate:2021-03-17
202104
   Twseclose
0      16215
15300 17100
        Date Type  Contract Strike Openinterest  id
0   20210318   買權  202104    15400           74   1
1   20210318   賣權  202104    15400         2148   2
2   20210318   買權  202104    15500           61   3
3   20210318   賣權  202104    15500         3805   4
4   20210318   買權  202104    15600          108   5
5   20210318   賣權  202104    15600         4975   6
6   20210318   買權  202104    15700          147   7
7   20210318   賣權  202104    15700         1495   8
8   20210318   買權  202104    15800          208   9
9   20210318   賣權  202104    15800         2742  10
10  20210318   買權  202104    15900          532  11
11  20210318   賣權  202104    15900         1742  12
12  20210318   買權  202104    16000         1376  13
13  20210318   賣權  202104    16000         3497  14
14  20210318   買權  202104    16100         1388  15
15  20210318   賣權  202104    16100         2662  16
16  20210318   買權  202104    16200         1533  17
17  20210318   賣權  202104    16200         3393  18
18  20210318   買權  202104    16300         3409  19
19  20210318   賣權  202104    16300         2399  20
20  20210318   買權  202104    16400         2436  21
21  20210318   賣權  202104    16400          633  22
22  20210318   買權  202104    16500         2584  23
23  20210318   賣權  202104    16500          222  24
24  20210318   買權  202104    16600         2120  25
25  20210318   賣權  202104    16600           78  26
26  20210318   買權  202104    16700         3513  27
27  20210318   賣權  202104    16700           99  28
28  20210318   買權  202104    16800         4008  29
29  20210318   賣權  202104    16800           43  30
30  20210318   買權  202104    16900         2260  31
31  20210318   賣權  202104    16900           41  32
32  20210318   買權  202104    17000         6689  33
33  20210318   賣權  202104    17000           59  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-19 09:30:04.177645
today:20210319
queryday:20210318
enddate:2021-03-17
202104
   Twseclose
0      16287
15300 17100
        Date Type  Contract Strike Openinterest  id
0   20210319   買權  202104    15400           96   1
1   20210319   賣權  202104    15400         2597   2
2   20210319   買權  202104    15500           71   3
3   20210319   賣權  202104    15500         4389   4
4   20210319   買權  202104    15600          168   5
5   20210319   賣權  202104    15600         4003   6
6   20210319   買權  202104    15700          201   7
7   20210319   賣權  202104    15700         1961   8
8   20210319   買權  202104    15800          287   9
9   20210319   賣權  202104    15800         2811  10
10  20210319   買權  202104    15900          590  11
11  20210319   賣權  202104    15900         2195  12
12  20210319   買權  202104    16000         2286  13
13  20210319   賣權  202104    16000         4595  14
14  20210319   買權  202104    16100         1751  15
15  20210319   賣權  202104    16100         2376  16
16  20210319   買權  202104    16200         2209  17
17  20210319   賣權  202104    16200         3477  18
18  20210319   買權  202104    16300         4779  19
19  20210319   賣權  202104    16300         2341  20
20  20210319   買權  202104    16400         4089  21
21  20210319   賣權  202104    16400          574  22
22  20210319   買權  202104    16500         2303  23
23  20210319   賣權  202104    16500          228  24
24  20210319   買權  202104    16600         2679  25
25  20210319   賣權  202104    16600           78  26
26  20210319   買權  202104    16700         3468  27
27  20210319   賣權  202104    16700          100  28
28  20210319   買權  202104    16800         5114  29
29  20210319   賣權  202104    16800           43  30
30  20210319   買權  202104    16900         3074  31
31  20210319   賣權  202104    16900           44  32
32  20210319   買權  202104    17000         6644  33
33  20210319   賣權  202104    17000           61  34
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
Date            object
Type            object
Contract        object
Strike          object
Openinterest    object
id               int64
dtype: object
now:2021-03-22 09:30:05.825848
today:20210322
queryday:20210319
enddate:2021-03-17
202104
   Twseclose
0      16070
15100 16900
Traceback (most recent call last):
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1586, in execute
    cur.execute(*args, **kwargs)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 692, in _read_packet
    packet_header = self._read_bytes(4)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 749, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query"
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1590, in execute
    self.con.rollback()
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 479, in rollback
    self._execute_command(COMMAND.COM_QUERY, "ROLLBACK")
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 793, in _execute_command
    raise err.InterfaceError(0, "")
pymysql.err.InterfaceError: (0, '')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 109, in <module>
    con=dbconn)  # size you want to fetch each time  
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 412, in read_sql
    chunksize=chunksize,
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1633, in read_query
    cursor = self.execute(*args)
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    raise ex from inner_exc
pandas.io.sql.DatabaseError: Execution failed on sql: select Date, Type, Contract, Strike, Openinterest from optiontable where Date="20210322" and Contract="202104" and strike>15100 and strike<16900 and Timesession="一般"  ;
(2013, 'Lost connection to MySQL server during query')
unable to rollback
Traceback (most recent call last):
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 614, in connect
    (self.host, self.port), self.connect_timeout, **kwargs
  File "/home/pfcf/anaconda3/lib/python3.7/socket.py", line 728, in create_connection
    raise err
  File "/home/pfcf/anaconda3/lib/python3.7/socket.py", line 716, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/pfcf/pfcfProject/OI/UpdateOI_MySQL.py", line 30, in <module>
    charset='utf8',
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 353, in __init__
    self.connect()
  File "/home/pfcf/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 664, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '103.17.9.213' ([Errno 111] Connection refused)")
